package taps2beats

import (
	"fmt"
	"time"
)

func ExampleFloats2Seconds() {
	var taps = [][]float64{
		{4.570271991, 5.063594027, 5.603539973, 6.102690998, 6.642708943, 7.141796968, 7.710649857, 8.192470916},
		{4.506176116, 5.045971061, 5.591722996, 6.114172975, 6.619153989, 7.135788980, 7.693071891, 8.203885893},
		{4.529560070, 5.057670039, 5.591721996, 6.137423930, 6.630941966, 7.176683900, 7.698974880, 8.227207848},
		{4.529560070, 5.069284016, 5.603428973, 6.102591998, 6.613455000, 7.147644957, 7.699120880, 8.215609871},
		{4.517865093, 5.022782107, 5.580101018, 6.096715009, 6.654118921, 7.176371900, 7.681405914, 8.215537871},
		{5.133092891, 5.545395086, 6.067721066, 6.578564068, 7.130096991, 7.652464971, 8.134273030},
		{4.494581138, 5.040234073, 5.562732052, 6.079333043, 6.624973977, 7.141650968, 7.664070948, 8.198270905},
		{4.529408070, 5.040295073, 5.556940064, 6.131584941, 6.654145921, 7.193876866, 7.722112835, 8.244539814},
		{4.523631082, 5.046071061, 5.586102007, 6.090995020, 6.596029034, 7.130224991, 7.652501971, 8.180805939},
		{4.517979093, 5.046165061, 5.551068075, 6.073547054, 6.607636011, 7.165018923, 7.687334903, 8.238953825},
		{4.517911093, 5.069403016, 5.586174007, 6.108568986, 6.578649068, 7.147523957, 7.681606914, 8.262110780},
	}

	seconds := Floats2Seconds(taps)

	for _, row := range seconds {
		fmt.Printf("%v\n", row)
	}

	// Output:
	// [4.570271991s 5.063594027s 5.603539973s 6.102690998s 6.642708943s 7.141796968s 7.710649857s 8.192470916s]
	// [4.506176116s 5.045971061s 5.591722996s 6.114172975s 6.619153989s 7.13578898s 7.693071891s 8.203885893s]
	// [4.52956007s 5.057670039s 5.591721996s 6.13742393s 6.630941966s 7.1766839s 7.69897488s 8.227207848s]
	// [4.52956007s 5.069284016s 5.603428973s 6.102591998s 6.613455s 7.147644957s 7.69912088s 8.215609871s]
	// [4.517865093s 5.022782107s 5.580101018s 6.096715009s 6.654118921s 7.1763719s 7.681405914s 8.215537871s]
	// [5.133092891s 5.545395086s 6.067721066s 6.578564068s 7.130096991s 7.652464971s 8.134273029s]
	// [4.494581138s 5.040234073s 5.562732052s 6.079333043s 6.624973977s 7.141650968s 7.664070948s 8.198270904s]
	// [4.52940807s 5.040295073s 5.556940064s 6.131584941s 6.654145921s 7.193876866s 7.722112835s 8.244539813s]
	// [4.523631082s 5.046071061s 5.586102007s 6.09099502s 6.596029034s 7.130224991s 7.652501971s 8.180805939s]
	// [4.517979093s 5.046165061s 5.551068075s 6.073547054s 6.607636011s 7.165018923s 7.687334903s 8.238953824s]
	// [4.517911093s 5.069403016s 5.586174007s 6.108568986s 6.578649068s 7.147523957s 7.681606914s 8.26211078s]
}

func ExampleSeconds() {
	seconds := Seconds(1.378)

	fmt.Printf("%v\n", seconds)

	// Output:
	// 1.378s
}

func ExampleTaps2Beats() {
	var taps = [][]float64{
		{4.570271991, 5.063594027, 5.603539973, 6.102690998, 6.642708943, 7.141796968, 7.710649857, 8.192470916},
		{4.506176116, 5.045971061, 5.591722996, 6.114172975, 6.619153989, 7.135788980, 7.693071891, 8.203885893},
		{4.529560070, 5.057670039, 5.591721996, 6.137423930, 6.630941966, 7.176683900, 7.698974880, 8.227207848},
		{4.529560070, 5.069284016, 5.603428973, 6.102591998, 6.613455000, 7.147644957, 7.699120880, 8.215609871},
		{4.517865093, 5.022782107, 5.580101018, 6.096715009, 6.654118921, 7.176371900, 7.681405914, 8.215537871},
		{5.133092891, 5.545395086, 6.067721066, 6.578564068, 7.130096991, 7.652464971, 8.134273030},
		{4.494581138, 5.040234073, 5.562732052, 6.079333043, 6.624973977, 7.141650968, 7.664070948, 8.198270905},
		{4.529408070, 5.040295073, 5.556940064, 6.131584941, 6.654145921, 7.193876866, 7.722112835, 8.244539814},
		{4.523631082, 5.046071061, 5.586102007, 6.090995020, 6.596029034, 7.130224991, 7.652501971, 8.180805939},
		{4.517979093, 5.046165061, 5.551068075, 6.073547054, 6.607636011, 7.165018923, 7.687334903, 8.238953825},
		{4.517911093, 5.069403016, 5.586174007, 6.108568986, 6.578649068, 7.147523957, 7.681606914, 8.262110780},
	}

	beats := Taps2Beats(Floats2Seconds(taps), 0.1)

	fmt.Printf("%v", beats)

	// Output:
	// BPM:    114
	// Offset: 308.705922ms
	//
	// 1   4.521425676s 4.521425676s 170.57µs     4.570271991s 4.506176116s 4.52956007s  4.52956007s  4.517865093s 4.494581138s 4.52940807s  4.523631082s 4.517979093s 4.517911093s
	// 2   5.057227139s 5.057227139s 491.965µs    5.063594027s 5.045971061s 5.057670039s 5.069284016s 5.022782107s 5.133092891s 5.040234073s 5.040295073s 5.046071061s 5.046165061s 5.069403016s
	// 3   5.574980844s 5.574980844s 250.732µs    5.603539973s 5.591722996s 5.591721996s 5.603428973s 5.580101018s 5.545395086s 5.562732052s 5.556940064s 5.586102007s 5.551068075s 5.586174007s
	// 4   6.09852893s  6.09852893s  306.897µs    6.102690998s 6.114172975s 6.13742393s  6.102591998s 6.096715009s 6.067721066s 6.079333043s 6.131584941s 6.09099502s  6.073547054s 6.108568986s
	// 5   6.614038897s 6.614038897s 481.988µs    6.642708943s 6.619153989s 6.630941966s 6.613455s    6.654118921s 6.578564068s 6.624973977s 6.654145921s 6.596029034s 6.607636011s 6.578649068s
	// 6   7.153758221s 7.153758221s 289.254µs    7.141796968s 7.13578898s  7.1766839s   7.147644957s 7.1763719s   7.130096991s 7.141650968s 7.193876866s 7.130224991s 7.165018923s 7.147523957s
	// 7   7.683459236s 7.683459236s 321.307µs    7.710649857s 7.693071891s 7.69897488s  7.69912088s  7.681405914s 7.652464971s 7.664070948s 7.722112835s 7.65250197s  7.687334903s 7.681606914s
	// 8   8.214640552s 8.214640552s 863.921µs    8.192470916s 8.203885893s 8.227207848s 8.215609871s 8.215537871s 8.134273028s 8.198270903s 8.244539812s 8.180805939s 8.238953823s 8.26211078s
}

func ExampleBeats_Quantize() {
	var taps = [][]float64{
		{4.570271991, 5.063594027, 5.603539973, 6.102690998, 6.642708943, 7.141796968, 7.710649857, 8.192470916},
		{4.506176116, 5.045971061, 5.591722996, 6.114172975, 6.619153989, 7.135788980, 7.693071891, 8.203885893},
		{4.529560070, 5.057670039, 5.591721996, 6.137423930, 6.630941966, 7.176683900, 7.698974880, 8.227207848},
		{4.529560070, 5.069284016, 5.603428973, 6.102591998, 6.613455000, 7.147644957, 7.699120880, 8.215609871},
		{4.517865093, 5.022782107, 5.580101018, 6.096715009, 6.654118921, 7.176371900, 7.681405914, 8.215537871},
		{5.133092891, 5.545395086, 6.067721066, 6.578564068, 7.130096991, 7.652464971, 8.134273030},
		{4.494581138, 5.040234073, 5.562732052, 6.079333043, 6.624973977, 7.141650968, 7.664070948, 8.198270905},
		{4.529408070, 5.040295073, 5.556940064, 6.131584941, 6.654145921, 7.193876866, 7.722112835, 8.244539814},
		{4.523631082, 5.046071061, 5.586102007, 6.090995020, 6.596029034, 7.130224991, 7.652501971, 8.180805939},
		{4.517979093, 5.046165061, 5.551068075, 6.073547054, 6.607636011, 7.165018923, 7.687334903, 8.238953825},
		{4.517911093, 5.069403016, 5.586174007, 6.108568986, 6.578649068, 7.147523957, 7.681606914, 8.262110780},
	}

	beats := Taps2Beats(Floats2Seconds(taps), 0.1)

	beats.Quantize()

	fmt.Printf("%v", beats)

	// Output:
	// BPM:    114
	// Offset: 308.705921ms
	//
	// 1   4.521611323s 4.521425676s 170.57µs     4.570271991s 4.506176116s 4.52956007s  4.52956007s  4.517865093s 4.494581138s 4.52940807s  4.523631082s 4.517979093s 4.517911093s
	// 2   5.048224498s 5.057227139s 491.965µs    5.063594027s 5.045971061s 5.057670039s 5.069284016s 5.022782107s 5.133092891s 5.040234073s 5.040295073s 5.046071061s 5.046165061s 5.069403016s
	// 3   5.574837674s 5.574980844s 250.732µs    5.603539973s 5.591722996s 5.591721996s 5.603428973s 5.580101018s 5.545395086s 5.562732052s 5.556940064s 5.586102007s 5.551068075s 5.586174007s
	// 4   6.101450849s 6.09852893s  306.897µs    6.102690998s 6.114172975s 6.13742393s  6.102591998s 6.096715009s 6.067721066s 6.079333043s 6.131584941s 6.09099502s  6.073547054s 6.108568986s
	// 5   6.628064024s 6.614038897s 481.988µs    6.642708943s 6.619153989s 6.630941966s 6.613455s    6.654118921s 6.578564068s 6.624973977s 6.654145921s 6.596029034s 6.607636011s 6.578649068s
	// 6   7.154677199s 7.153758221s 289.254µs    7.141796968s 7.13578898s  7.1766839s   7.147644957s 7.1763719s   7.130096991s 7.141650968s 7.193876866s 7.130224991s 7.165018923s 7.147523957s
	// 7   7.681290374s 7.683459236s 321.307µs    7.710649857s 7.693071891s 7.69897488s  7.69912088s  7.681405914s 7.652464971s 7.664070948s 7.722112835s 7.65250197s  7.687334903s 7.681606914s
	// 8   8.20790355s  8.214640552s 863.921µs    8.192470916s 8.203885893s 8.227207848s 8.215609871s 8.215537871s 8.134273028s 8.198270903s 8.244539812s 8.180805939s 8.238953823s 8.26211078s
}

func ExampleBeats_Interpolate() {
	var taps = [][]float64{
		{4.570271991, 5.063594027, 5.603539973, 6.102690998, 6.642708943, 7.141796968, 7.710649857, 8.192470916},
		{4.506176116, 5.045971061, 5.591722996, 6.114172975, 6.619153989, 7.135788980, 7.693071891, 8.203885893},
		{4.529560070, 5.057670039, 5.591721996, 6.137423930, 6.630941966, 7.176683900, 7.698974880, 8.227207848},
		{4.529560070, 5.069284016, 5.603428973, 6.102591998, 6.613455000, 7.147644957, 7.699120880, 8.215609871},
		{4.517865093, 5.022782107, 5.580101018, 6.096715009, 6.654118921, 7.176371900, 7.681405914, 8.215537871},
		{5.133092891, 5.545395086, 6.067721066, 6.578564068, 7.130096991, 7.652464971, 8.134273030},
		{4.494581138, 5.040234073, 5.562732052, 6.079333043, 6.624973977, 7.141650968, 7.664070948, 8.198270905},
		{4.529408070, 5.040295073, 5.556940064, 6.131584941, 6.654145921, 7.193876866, 7.722112835, 8.244539814},
		{4.523631082, 5.046071061, 5.586102007, 6.090995020, 6.596029034, 7.130224991, 7.652501971, 8.180805939},
		{4.517979093, 5.046165061, 5.551068075, 6.073547054, 6.607636011, 7.165018923, 7.687334903, 8.238953825},
		{4.517911093, 5.069403016, 5.586174007, 6.108568986, 6.578649068, 7.147523957, 7.681606914, 8.262110780},
	}

	beats := Taps2Beats(Floats2Seconds(taps), 0.1)
	start := 1 * time.Second
	end := 10 * time.Second

	beats.Interpolate(start, end)

	fmt.Printf("%v", beats)

	// Output:
	// BPM:    114
	// Offset: 308.705921ms
	//
	// 1   1.361932272s
	// 2   1.888545447s
	// 3   2.415158623s
	// 4   2.941771798s
	// 5   3.468384973s
	// 6   3.994998148s
	// 7   4.521425676s 4.521425676s 170.57µs     4.570271991s 4.506176116s 4.52956007s  4.52956007s  4.517865093s 4.494581138s 4.52940807s  4.523631082s 4.517979093s 4.517911093s
	// 8   5.057227139s 5.057227139s 491.965µs    5.063594027s 5.045971061s 5.057670039s 5.069284016s 5.022782107s 5.133092891s 5.040234073s 5.040295073s 5.046071061s 5.046165061s 5.069403016s
	// 9   5.574980844s 5.574980844s 250.732µs    5.603539973s 5.591722996s 5.591721996s 5.603428973s 5.580101018s 5.545395086s 5.562732052s 5.556940064s 5.586102007s 5.551068075s 5.586174007s
	// 10  6.09852893s  6.09852893s  306.897µs    6.102690998s 6.114172975s 6.13742393s  6.102591998s 6.096715009s 6.067721066s 6.079333043s 6.131584941s 6.09099502s  6.073547054s 6.108568986s
	// 11  6.614038897s 6.614038897s 481.988µs    6.642708943s 6.619153989s 6.630941966s 6.613455s    6.654118921s 6.578564068s 6.624973977s 6.654145921s 6.596029034s 6.607636011s 6.578649068s
	// 12  7.153758221s 7.153758221s 289.254µs    7.141796968s 7.13578898s  7.1766839s   7.147644957s 7.1763719s   7.130096991s 7.141650968s 7.193876866s 7.130224991s 7.165018923s 7.147523957s
	// 13  7.683459236s 7.683459236s 321.307µs    7.710649857s 7.693071891s 7.69897488s  7.69912088s  7.681405914s 7.652464971s 7.664070948s 7.722112835s 7.65250197s  7.687334903s 7.681606914s
	// 14  8.214640552s 8.214640552s 863.921µs    8.192470916s 8.203885893s 8.227207848s 8.215609871s 8.215537871s 8.134273028s 8.198270903s 8.244539812s 8.180805939s 8.238953823s 8.26211078s
	// 15  8.734516725s
	// 16  9.2611299s
	// 17  9.787743075s
}

func ExampleBeats_Round() {
	var taps = [][]float64{
		{4.570271991, 5.063594027, 5.603539973, 6.102690998, 6.642708943, 7.141796968, 7.710649857, 8.192470916},
		{4.506176116, 5.045971061, 5.591722996, 6.114172975, 6.619153989, 7.135788980, 7.693071891, 8.203885893},
		{4.529560070, 5.057670039, 5.591721996, 6.137423930, 6.630941966, 7.176683900, 7.698974880, 8.227207848},
		{4.529560070, 5.069284016, 5.603428973, 6.102591998, 6.613455000, 7.147644957, 7.699120880, 8.215609871},
		{4.517865093, 5.022782107, 5.580101018, 6.096715009, 6.654118921, 7.176371900, 7.681405914, 8.215537871},
		{5.133092891, 5.545395086, 6.067721066, 6.578564068, 7.130096991, 7.652464971, 8.134273030},
		{4.494581138, 5.040234073, 5.562732052, 6.079333043, 6.624973977, 7.141650968, 7.664070948, 8.198270905},
		{4.529408070, 5.040295073, 5.556940064, 6.131584941, 6.654145921, 7.193876866, 7.722112835, 8.244539814},
		{4.523631082, 5.046071061, 5.586102007, 6.090995020, 6.596029034, 7.130224991, 7.652501971, 8.180805939},
		{4.517979093, 5.046165061, 5.551068075, 6.073547054, 6.607636011, 7.165018923, 7.687334903, 8.238953825},
		{4.517911093, 5.069403016, 5.586174007, 6.108568986, 6.578649068, 7.147523957, 7.681606914, 8.262110780},
	}

	beats := Taps2Beats(Floats2Seconds(taps), 0.1)

	beats.Round(1 * time.Millisecond)

	fmt.Printf("%v", beats)

	// Output:
	// BPM:    114
	// Offset: 309ms
	//
	// 1   4.521s 4.521s 0s     4.57s  4.506s 4.53s  4.53s  4.518s 4.495s 4.529s 4.524s 4.518s 4.518s
	// 2   5.057s 5.057s 0s     5.064s 5.046s 5.058s 5.069s 5.023s 5.133s 5.04s  5.04s  5.046s 5.046s 5.069s
	// 3   5.575s 5.575s 0s     5.604s 5.592s 5.592s 5.603s 5.58s  5.545s 5.563s 5.557s 5.586s 5.551s 5.586s
	// 4   6.099s 6.099s 0s     6.103s 6.114s 6.137s 6.103s 6.097s 6.068s 6.079s 6.132s 6.091s 6.074s 6.109s
	// 5   6.614s 6.614s 0s     6.643s 6.619s 6.631s 6.613s 6.654s 6.579s 6.625s 6.654s 6.596s 6.608s 6.579s
	// 6   7.154s 7.154s 0s     7.142s 7.136s 7.177s 7.148s 7.176s 7.13s  7.142s 7.194s 7.13s  7.165s 7.148s
	// 7   7.683s 7.683s 0s     7.711s 7.693s 7.699s 7.699s 7.681s 7.652s 7.664s 7.722s 7.653s 7.687s 7.682s
	// 8   8.215s 8.215s 1ms    8.192s 8.204s 8.227s 8.216s 8.216s 8.134s 8.198s 8.245s 8.181s 8.239s 8.262s
}

func ExampleBeats_Sub() {
	var taps = [][]float64{
		{4.570271991, 5.063594027, 5.603539973, 6.102690998, 6.642708943, 7.141796968, 7.710649857, 8.192470916},
		{4.506176116, 5.045971061, 5.591722996, 6.114172975, 6.619153989, 7.135788980, 7.693071891, 8.203885893},
		{4.529560070, 5.057670039, 5.591721996, 6.137423930, 6.630941966, 7.176683900, 7.698974880, 8.227207848},
		{4.529560070, 5.069284016, 5.603428973, 6.102591998, 6.613455000, 7.147644957, 7.699120880, 8.215609871},
		{4.517865093, 5.022782107, 5.580101018, 6.096715009, 6.654118921, 7.176371900, 7.681405914, 8.215537871},
		{5.133092891, 5.545395086, 6.067721066, 6.578564068, 7.130096991, 7.652464971, 8.134273030},
		{4.494581138, 5.040234073, 5.562732052, 6.079333043, 6.624973977, 7.141650968, 7.664070948, 8.198270905},
		{4.529408070, 5.040295073, 5.556940064, 6.131584941, 6.654145921, 7.193876866, 7.722112835, 8.244539814},
		{4.523631082, 5.046071061, 5.586102007, 6.090995020, 6.596029034, 7.130224991, 7.652501971, 8.180805939},
		{4.517979093, 5.046165061, 5.551068075, 6.073547054, 6.607636011, 7.165018923, 7.687334903, 8.238953825},
		{4.517911093, 5.069403016, 5.586174007, 6.108568986, 6.578649068, 7.147523957, 7.681606914, 8.262110780},
	}

	beats := Taps2Beats(Floats2Seconds(taps), 0.1)

	beats.Sub(129 * time.Millisecond)

	fmt.Printf("%v", beats)

	// Output:
	// BPM:    114
	// Offset: 179.705922ms
	//
	// 1   4.392425676s 4.392425676s 170.57µs     4.441271991s 4.377176116s 4.40056007s  4.40056007s  4.388865093s 4.365581138s 4.40040807s  4.394631082s 4.388979093s 4.388911093s
	// 2   4.928227139s 4.928227139s 491.965µs    4.934594027s 4.916971061s 4.928670039s 4.940284016s 4.893782107s 5.004092891s 4.911234073s 4.911295073s 4.917071061s 4.917165061s 4.940403016s
	// 3   5.445980844s 5.445980844s 250.732µs    5.474539973s 5.462722996s 5.462721996s 5.474428973s 5.451101018s 5.416395086s 5.433732052s 5.427940064s 5.457102007s 5.422068075s 5.457174007s
	// 4   5.96952893s  5.96952893s  306.897µs    5.973690998s 5.985172975s 6.00842393s  5.973591998s 5.967715009s 5.938721066s 5.950333043s 6.002584941s 5.96199502s  5.944547054s 5.979568986s
	// 5   6.485038897s 6.485038897s 481.988µs    6.513708943s 6.490153989s 6.501941966s 6.484455s    6.525118921s 6.449564068s 6.495973977s 6.525145921s 6.467029034s 6.478636011s 6.449649068s
	// 6   7.024758221s 7.024758221s 289.254µs    7.012796968s 7.00678898s  7.0476839s   7.018644957s 7.0473719s   7.001096991s 7.012650968s 7.064876866s 7.001224991s 7.036018923s 7.018523957s
	// 7   7.554459236s 7.554459236s 321.307µs    7.581649857s 7.564071891s 7.56997488s  7.57012088s  7.552405914s 7.523464971s 7.535070948s 7.593112835s 7.52350197s  7.558334903s 7.552606914s
	// 8   8.085640552s 8.085640552s 863.921µs    8.063470916s 8.074885893s 8.098207848s 8.086609871s 8.086537871s 8.005273028s 8.069270903s 8.115539812s 8.051805939s 8.109953823s 8.13311078s
}
